# คู่มือการ Restore ระบบ FunAging.club

คู่มือนี้อธิบายการใช้งานระบบเวอร์ชัน และการ Restore ย้อนกลับทีละระดับ

---

## แนวคิดหลัก

- ทุกครั้งที่คุณ “ปิดงานใหญ่” เช่น เชื่อม Media OS, เพิ่มระบบอ่านเอกสาร ฯลฯ  
  ให้ใช้คำสั่งสร้างเวอร์ชันใหม่ (NEW VERSION) เพื่อบันทึกจุดสำคัญของระบบ
- ระบบจะเก็บข้อมูลเวอร์ชันไว้ในโฟลเดอร์ \ersions\ เช่น:
  - \ersions\v1.json\
  - \ersions\v2.json\
  - \ersions\v3.json\
- การ Restore จะ **ย้อนกลับได้ทีละระดับเท่านั้น**
  - v4 → v3 → v2 → v1
  - ไม่อนุญาตให้กระโดดข้าม เช่น v4  v1 โดยตรง

---

## คำสั่งสำคัญ

> หมายเหตุ: คำสั่งต่อไปนี้รันใน PowerShell / Cursor Terminal ที่โฟลเดอร์โปรเจกต์นี้

### 1) สร้างเวอร์ชันใหม่

เมื่อพัฒนาเสร็จถึงจุดที่อยากตั้งเป็นเวอร์ชัน เช่น เชื่อม Media OS สำเร็จ

1. ให้ commit โค้ดใน git ให้เรียบร้อยก่อน
2. แล้วรันคำสั่ง:

\\\
.\new-version.ps1 "คำอธิบายเวอร์ชัน เช่น เชื่อม Media OS สำเร็จ"
\\\

ผลลัพธ์:
- สร้าง tag ใหม่ใน git: v1, v2, v3, ...
- บันทึกข้อมูลเวอร์ชันในไฟล์ \ersions\vX.json\
- อัปเดตเลขเวอร์ชันล่าสุดใน \ersions\meta.json\

---

### 2) ดูรายการเวอร์ชันทั้งหมด

\\\
.\show-versions.ps1
\\\

ระบบจะแสดง:
- v1 – อธิบายสั้น ๆ ว่าทำอะไรเสร็จ
- v2 – ต่อเติมอะไรเพิ่ม
- v3 – เชื่อมระบบอะไรแล้ว
ฯลฯ

---

### 3) Restore ย้อนกลับทีละ Level

ตัวอย่าง: ตอนนี้ระบบกำลังทำ v4 แล้วพัง อยากย้อนกลับไปใช้ v3

ให้รัน:

\\\
.\restore-prev-version.ps1
\\\

ระบบจะทำงานดังนี้:
1. ตรวจเวอร์ชันล่าสุดจาก \meta.json\
2. หาเวอร์ชันก่อนหน้า (current-1)
3. ยืนยันก่อน Restore (ให้พิมพ์ YES)
4. Backup โค้ดปัจจุบันเก็บไว้ในโฟลเดอร์ \ersions\backup-ก่อน-restore-เวลา\
5. ใช้ git reset กลับไปยัง tag ของเวอร์ชันก่อนหน้า
6. npm install + npm run build เพื่อตรวจสอบว่าระบบยัง build ได้
7. แสดงผลว่า Restore สำเร็จ

**สำคัญ:**  
- คำสั่งนี้จะย้อนกลับทีละขั้นเท่านั้น (เช่น v4 → v3)
- ถ้าต้องการย้อนจาก v4 → v2 ต้องรัน 2 ครั้ง:
  - ครั้งที่ 1: v4 → v3
  - ครั้งที่ 2: v3  v2

---

## ข้อควรระวัง

- ก่อนใช้ \.\new-version.ps1\ ควร commit โค้ดให้เรียบร้อย
- อย่าลบไฟล์ในโฟลเดอร์ \ersions\ ด้วยตัวเอง
- อย่าแก้ไขไฟล์ \X.json\ และ \meta.json\ โดยไม่จำเป็น
- ถ้าจะ Restore ให้ตั้งสติ อ่านข้อความยืนยันให้ครบ แล้วค่อยพิมพ์ YES

---

## สรุปสั้น ๆ

- ใช้ \.\new-version.ps1 "คำอธิบาย"\ เมื่อระบบไปถึงจุดสำคัญ → สร้างเวอร์ชันใหม่
- ใช้ \.\show-versions.ps1\ เพื่อดูว่าแต่ละเวอร์ชันทำอะไรไปแล้ว
- ใช้ \.\restore-prev-version.ps1\ เพื่อย้อนกลับทีละขั้นเมื่อระบบพัง

ระบบนี้ช่วยให้:
- พัฒนาต่อไปได้อย่างมั่นใจ
- ถ้าพัง ก็ย้อนกลับเวอร์ชันก่อนหน้าได้เสมอ
